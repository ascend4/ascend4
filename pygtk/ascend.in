#!/bin/sh

if [ "x$ASCENDLIBRARY" != "x" ]; then
    echo "USING ASCENDLIBRARY=$ASCENDLIBRARY"
else
    ASCENDLIBRARY=@DEFAULT_ASCENDLIBRARY@
fi

args=$@

if [ "$OSTYPE" = "cygwin" ]; then
    echo "CYGWIN..."
elif [ "$OSTYPE" = "msys" ]; then
    #echo "MSYS..."
    PYTHON=/c/Python24/python
fi

if [ $PYTHON ]; then 
    python=$PYTHON
else
    python=python
fi


if [ $ASC_GDB ]; then
	echo "RUNNING THROUGH DEBUGGER"
	ASC_DEBUGGER="gdb --symbols=../@ASC_SHLIBPREFIX@ascend@ASC_SHLIBSUFFIX@ --args" 
fi

if [ "x$ASC_DEBUGGER" != "x" ]; then
	bin="$ASC_DEBUGGER $python"
else
	bin="$python"
fi

# if 'ascend' isn't in the path, assume ASC_DEV mode...
whichascend=`which ascend &2>/dev/null`
if [ $whichascend ]; then
	echo $whichascend " ?"
else
	ASC_DEV=1
fi

if [ "x$ASC_TEST" != "x" ]; then
	# set the 'ASC_TEST' env var to run the suite of
	# unit tests instead of running ASCEND GUI.
	echo "LAUNCHING ASCEND TEST SUITE..."
	export LD_LIBRARY_PATH=..
	cmd="$bin test.py"
else
	if [ "x$ASC_DEV" != "x" ]; then
		# set the 'ASC_DEV' environment variable
		# if you don't want to run ASCEND from the installed location
		echo "NOTE! RUNNING ASC_DEV (LOCAL) MODE..."
		export LD_LIBRARY_PATH=..
		cmd="$bin gtkbrowser.py --pygtk-assets=glade/ --library=../models $args"
		echo "Launching... $cmd"
	else
		cmd="$bin @INSTALL_ASCDATA@/gtkbrowser.py $args"
	fi
fi

$cmd

